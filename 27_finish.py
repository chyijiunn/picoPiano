from machine import Pin, PWM
from utime import sleep
from picozero import Speaker
import math
buzzer = PWM(Pin(21))
speaker = Speaker(21)
for i in range(16):
    exec('button' + str(i) + ' = Pin(' + str(i) + ',Pin.IN, Pin.PULL_UP)' )
t = 60 / 180  # 每分鐘 180 拍

tune = [
    #0
    [['a4', t / 2], ['c5', t / 2], ['e5', t], ['g5', t],['f#5', t], ['d5', t * 1.5], ['e5', t / 2], ['a4', t],['g5', t], ['f#5', t / 2], ['e5', t / 2], ['c5', t],['d5', t * 1.5], ['e5', t / 2], ['a4', t], ['g4', t * 2],['c5', t / 2], ['e5', t / 2], ['g5', t], ['b5', t],['a5', t], ['f#5', t * 1.5], ['g5', t / 2], ['c5', t],['b5', t], ['a5', t / 2], ['g5', t / 2], ['e5', t],['f#5', t * 1.5], ['g5', t / 2], ['c5', t], ['b4', t * 2]],
    #1
    [['e5', t / 2], ['e5', t / 2], ['e5', t],['c5', t / 2],['e5', t],['g5', t * 1.5],['g4', t * 1.5],['c5', t],['g4', t * 1.5],['e4', t * 1.5],['a4', t],['b4', t / 2],['a#4', t / 2],['a4', t],['g4', t],['e5', t / 2],['g5', t / 2],['a5', t],['f5', t / 2],['g5', t / 2],['e5', t / 2],['c5', t / 2],['d5', t / 2],['b4', t * 1.5],['g4', t / 2],['e4', t * 1.5],['a4', t],['b4', t / 2],['a#4', t / 2],['a4', t],['g4', t]],
    #2
    [['b4', t / 4], ['c5', t / 4], ['c#5', t / 4], ['d5', t / 4], ['c#5', t / 4], ['c5', t / 4], ['b4', t / 4], ['a#4', t / 4],['b4', t / 4], ['c5', t / 4], ['c#5', t / 4], ['d5', t / 4], ['c#5', t / 4], ['c5', t / 4], ['b4', t / 4], ['a4', t / 4]],
    #3
    [['g4', t / 6], ['a4', t / 6], ['b4', t / 6], ['a4', t / 6], ['g4', t / 6], ['f#4', t / 6], ['g4', t / 6], ['a4', t / 6],['b4', t / 6], ['c5', t / 6], ['d5', t / 6], ['c5', t / 6], ['b4', t / 6], ['a4', t / 6], ['g4', t / 6], ['f#4', t / 6]],
    #4
    [['d6', t / 4], ['c#6', t / 4], ['b5', t / 4], ['a5', t / 4], ['g5', t / 4], ['a5', t / 4], ['b5', t / 4], ['c6', t / 4],['d6', t / 4], ['e6', t / 4], ['f#6', t / 4], ['g6', t / 4], ['f#6', t / 4], ['e6', t / 4], ['d6', t / 4], ['c6', t / 4]],
    #5
    [['b4', t / 4], ['g4', t / 4], ['d5', t / 4], ['a4', t / 4], ['e5', t / 4], ['b4', t / 4], ['f#5', t / 4], ['c5', t / 4],['g5', t / 4], ['d5', t / 4], ['a5', t / 4], ['e5', t / 4], ['b5', t / 4], ['f#5', t / 4], ['c6', t / 4], ['g5', t / 4]],
    #6）
    [['f4', t / 4], ['a4', t / 4], ['c5', t / 4], ['d5', t / 4], ['e5', t / 4], ['g5', t / 4], ['b5', t / 4], ['c6', t / 4],['d6', t / 4], ['e6', t / 4], ['f6', t / 4], ['g6', t / 4], ['a6', t / 4], ['b6', t / 4], ['c7', t / 4], ['d7', t / 4]],
    #7
    [['b4', t / 4], ['c5', t / 4], ['d5', t / 4], ['f5', t / 4], ['e5', t / 4], ['d5', t / 4], ['c5', t / 4], ['b4', t / 4],['g4', t / 4], ['a4', t / 4], ['b4', t / 4], ['d5', t / 4], ['c5', t / 4], ['b4', t / 4], ['a4', t / 4], ['g4', t / 4]],
    #8
    [['a4', t / 4], ['b4', t / 4], ['c5', t / 4], ['d5', t / 4], ['e5', t / 4], ['f#5', t / 4], ['g5', t / 4], ['a5', t / 4],['b5', t / 4], ['c6', t / 4], ['d6', t / 4], ['e6', t / 4], ['f#6', t / 4], ['g6', t / 4], ['a6', t / 4], ['b6', t / 4]],
    #9
    [['d6', t / 4], ['c6', t / 4], ['b5', t / 4], ['a5', t / 4], ['g5', t / 4], ['f#5', t / 4], ['e5', t / 4], ['d5', t / 4],['c5', t / 4], ['b4', t / 4], ['a4', t / 4], ['g4', t / 4], ['f#4', t / 4], ['e4', t / 4], ['d4', t / 4], ['c4', t / 4]]
    ]

n=69

def noteplay(note):
    buzzer.duty_u16(1000) # Volumn
    buzzer.freq(note)
    sleep(0.08)                                                                          
    buzzer.duty_u16(0)
    
def musicMode():
    while True:
        for i in range(10):#可增加到15，對應鍵盤 GP0~15，有幾首，就改多少
            exec('if button'+str(15-i)+'.value() == 0:speaker.play(tune['+str(i)+'])')
while True:
    for i in range(16):exec('if button'+str(15-i)+'.value() == 0:noteplay(int(round(440*math.pow(2,(n-69+i)/12),0)))')
    if button14.value() == 0 and button15.value() == 0 :musicMode()#同時按下 GP 15,14 進入音樂模式